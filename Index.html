<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Team Question Machine (Random • No Repeats)</title>
  <style>
    :root{
      --bg1:#fff7fb;
      --bg2:#f3fbff;
      --ink:#1b1b1f;
      --muted:#5b5b66;
      --panel:#ffffff;
      --stroke: rgba(35, 35, 40, .18);
      --shadow: 0 18px 45px rgba(20, 20, 30, .12);
      --accent:#6c5ce7;
      --accent2:#00c2a8;
      --accent3:#ff6b9a;
      --btn:#1f2430;
      --btnText:#ffffff;
      --chip:#f7f7fb;
      --ring: 0 0 0 3px rgba(108, 92, 231, .25);
      --radius: 18px;
    }

    /* Respect user preference */
    @media (prefers-color-scheme: dark){
      :root{
        --bg1:#0b0b12;
        --bg2:#101827;
        --ink:#f2f3f7;
        --muted:#b7b8c2;
        --panel:#121624;
        --stroke: rgba(255,255,255,.14);
        --shadow: 0 18px 45px rgba(0,0,0,.55);
        --btn:#f2f3f7;
        --btnText:#121624;
        --chip:#151a2b;
        --ring: 0 0 0 3px rgba(0, 194, 168, .25);
      }
    }

    *{ box-sizing: border-box; }
    body{
      margin: 0;
      min-height: 100vh;
      font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--ink);
      background:
        radial-gradient(circle at 12px 12px, rgba(255,107,154,.18) 2px, transparent 3px) 0 0/28px 28px,
        radial-gradient(circle at 26px 24px, rgba(0,194,168,.15) 2px, transparent 3px) 0 0/34px 34px,
        linear-gradient(135deg, var(--bg1), var(--bg2));
      padding: 40px 18px;
      display: grid;
      place-items: center;
    }

    .wrap{ width: min(980px, 100%); }

    .marquee{
      display:flex;
      gap: 10px;
      align-items:center;
      justify-content:center;
      margin-bottom: 16px;
      user-select:none;
    }

    .pill{
      font-size: 12px;
      letter-spacing: .08em;
      text-transform: uppercase;
      padding: 8px 12px;
      border-radius: 999px;
      background: color-mix(in srgb, var(--panel) 85%, transparent);
      border: 1px solid var(--stroke);
      box-shadow: 0 8px 18px rgba(0,0,0,.06);
      color: var(--muted);
    }

    .machine{
      position: relative;
      border-radius: calc(var(--radius) + 10px);
      background: linear-gradient(180deg, color-mix(in srgb, var(--panel) 96%, transparent), var(--panel));
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    /* Cute header with stripes */
    .machine::before{
      content:"";
      position:absolute;
      inset: 0 0 auto 0;
      height: 92px;
      background:
        repeating-linear-gradient(45deg,
          rgba(108,92,231,.14) 0 14px,
          rgba(0,194,168,.12) 14px 28px,
          rgba(255,107,154,.12) 28px 42px
        );
      border-bottom: 1px solid var(--stroke);
    }

    .top{
      position: relative;
      padding: 18px 20px 14px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
    }

    .title{
      margin: 0;
      font-size: 22px;
      line-height: 1.1;
    }
    .subtitle{
      margin: 6px 0 0;
      font-size: 13px;
      color: var(--muted);
    }

    .badge{
      margin-top: 2px;
      display:inline-flex;
      align-items:center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: 14px;
      background: color-mix(in srgb, var(--panel) 82%, transparent);
      border: 1px solid var(--stroke);
      white-space: nowrap;
    }
    .leds{
      display:flex;
      gap: 6px;
    }
    .led{
      width: 10px; height: 10px;
      border-radius: 999px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.9);
      box-shadow: 0 0 0 2px rgba(255,255,255,.25) inset;
    }
    .led.p{ background: var(--accent3); }
    .led.g{ background: var(--accent2); }
    .led.v{ background: var(--accent); }

    .panel{
      position: relative;
      padding: 20px;
      display:grid;
      grid-template-columns: 1.3fr .7fr;
      gap: 18px;
    }

    @media (max-width: 780px){
      .panel{ grid-template-columns: 1fr; }
    }

    .screen{
      border-radius: var(--radius);
      border: 1px solid var(--stroke);
      background:
        radial-gradient(circle at 24px 24px, rgba(108,92,231,.10) 0 18px, transparent 19px),
        radial-gradient(circle at 68px 52px, rgba(0,194,168,.09) 0 16px, transparent 17px),
        radial-gradient(circle at 120px 34px, rgba(255,107,154,.09) 0 14px, transparent 15px),
        linear-gradient(180deg, color-mix(in srgb, var(--panel) 94%, transparent), color-mix(in srgb, var(--panel) 86%, transparent));
      padding: 18px 18px 16px;
      min-height: 190px;
      display:flex;
      flex-direction: column;
      justify-content: space-between;
      gap: 14px;
    }

    .question{
      font-size: clamp(20px, 2.4vw, 28px);
      line-height: 1.25;
      margin: 0;
    }

    .meta{
      font-size: 12px;
      color: var(--muted);
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items:center;
    }
    .chip{
      background: var(--chip);
      border: 1px solid var(--stroke);
      border-radius: 999px;
      padding: 6px 10px;
    }

    .controls{
      border-radius: var(--radius);
      border: 1px solid var(--stroke);
      background: color-mix(in srgb, var(--panel) 92%, transparent);
      padding: 16px;
      display:flex;
      flex-direction: column;
      gap: 10px;
    }

    .btnRow{ display:flex; gap:10px; flex-wrap:wrap; }
    button, input{
      font: inherit;
      border-radius: 14px;
      border: 1px solid var(--stroke);
      padding: 10px 12px;
    }
    button{
      cursor: pointer;
      background: var(--btn);
      color: var(--btnText);
      box-shadow: 0 10px 20px rgba(0,0,0,.12);
      transform: translateY(0);
      transition: transform .06s ease, filter .12s ease;
    }
    button:hover{ filter: brightness(1.05); }
    button:active{ transform: translateY(1px); }
    button:focus-visible{ outline: none; box-shadow: var(--shadow), var(--ring); }

    .secondary{
      background: transparent;
      color: var(--ink);
      box-shadow: none;
    }

    input{
      width: 100%;
      background: color-mix(in srgb, var(--panel) 94%, transparent);
      color: var(--ink);
    }
    input:focus{ outline: none; box-shadow: var(--ring); }

    .leverWrap{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      margin-top: 4px;
    }
    .leverLabel{
      font-size: 12px;
      color: var(--muted);
    }
    .lever{
      width: 58px;
      height: 58px;
      border-radius: 16px;
      border: 1px solid var(--stroke);
      background: linear-gradient(180deg, color-mix(in srgb, var(--panel) 95%, transparent), color-mix(in srgb, var(--panel) 75%, transparent));
      display:grid;
      place-items:center;
      position: relative;
      overflow:hidden;
    }
    .lever::before{
      content:"";
      width: 16px;
      height: 34px;
      border-radius: 999px;
      background: linear-gradient(180deg, var(--accent3), var(--accent));
      box-shadow: 0 10px 18px rgba(0,0,0,.18);
      transform: rotate(0deg);
      transition: transform .12s ease;
    }
    .lever.pulled::before{ transform: rotate(22deg) translateY(1px); }

    details{ padding: 0 20px 18px; }
    summary{ cursor:pointer; color: var(--muted); }
    details p{ color: var(--muted); margin: 10px 0 0; font-size: 13px; }

    /* tiny footer window */
    .bottomBar{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items:center;
      justify-content: space-between;
      padding: 14px 20px 18px;
      border-top: 1px solid var(--stroke);
      background: color-mix(in srgb, var(--panel) 90%, transparent);
    }
    .tiny{
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="marquee">
      <div class="pill">Random</div>
      <div class="pill">No repeats</div>
      <div class="pill">500 questions</div>
    </div>

    <div class="machine" role="region" aria-label="Team Question Machine">
      <div class="top">
        <div>
          <h1 class="title">Team Question Machine</h1>
          <p class="subtitle">Pull the lever. Get a question. Repeat (eventually).</p>
        </div>
        <div class="badge" aria-label="Status lights">
          <div class="leds" aria-hidden="true">
            <span class="led p"></span>
            <span class="led g"></span>
            <span class="led v"></span>
          </div>
          <span style="font-size:12px;color:var(--muted);">Ready</span>
        </div>
      </div>

      <div class="panel">
        <div class="screen">
          <p id="question" class="question" aria-live="polite"></p>
          <div class="meta" id="meta"></div>
        </div>

        <div class="controls" aria-label="Controls">
          <div class="btnRow">
            <button id="nextBtn" type="button" aria-label="Next question">Next</button>
            <button id="copyBtn" class="secondary" type="button">Copy link</button>
            <button id="resetBtn" class="secondary" type="button">Reset</button>
          </div>

          <label style="font-size:12px;color:var(--muted);">Shareable link (locks this question)</label>
          <input id="linkBox" type="text" readonly aria-label="Shareable link" />

          <div class="leverWrap">
            <div>
              <div class="leverLabel">Fun mode</div>
              <div class="leverLabel" style="opacity:.85;">(totally optional)</div>
            </div>
            <div class="lever" id="lever" aria-hidden="true"></div>
          </div>
        </div>
      </div>

      <div class="bottomBar">
        <div class="tiny">Tip: Use <b>Copy link</b> to paste a consistent question into Teams/agenda.</div>
        <div class="tiny" id="bankInfo"></div>
      </div>

      <details>
        <summary>Admin notes (optional)</summary>
        <p>
          This page generates 500 playful, work-appropriate questions (no seasonal/holiday prompts).
          Questions are randomized and will not repeat until the entire set is used, then it reshuffles.
          Progress is remembered per browser/device using local storage.
        </p>
      </details>
    </div>
  </div>

  <script>
    const TARGET_COUNT = 500;
    const STORAGE_KEY  = "team_qotd_v2";

    const BANK = {
      adjectives: [
        "oddly satisfying","low-key","surprisingly useful","underrated","overhyped",
        "cozy","chaotic (in a fun way)","tiny but mighty","wholesome","ridiculously specific",
        "unnecessarily fancy","unexpected","delightfully random","weirdly effective","simple"
      ],
      topics: [
        "snack","drink","song","playlist","movie","show","book","podcast","YouTube channel",
        "app","website","tool","keyboard shortcut","desktop setup tweak","phone setting",
        "restaurant","comfort food","dessert","cuisine","scent","color","animal","mythical creature",
        "hobby","board game","party game","museum","place to visit","road trip stop"
      ],
      activities: [
        "relax after work","reset your brain when you’re stuck","celebrate a small win",
        "start your morning","wind down at night","kill time while waiting","spark creativity",
        "get motivated","learn something new","make chores less annoying"
      ],
      workBits: [
        "email","meetings","planning","brainstorming","writing","designing","organizing files",
        "keeping track of tasks","collaboration","presenting","reviewing feedback"
      ],
      questionsPeople: [
        "a fictional character","a celebrity","a historical figure","an athlete","a musician",
        "a chef","an author","a scientist","an artist","a cartoon character"
      ],
      superpowers: [
        "pause time","teleport","speak every language","instantly learn any skill","never lose your keys",
        "perfect memory for names","always find parking","turn any leftovers into something good",
        "fall asleep on command","make any software behave"
      ],
      smallJoys: [
        "a fresh notebook","a perfectly timed meme","good background music","a clean inbox",
        "the first sip of your favorite drink","a comfy hoodie","sunlight through a window",
        "a perfectly ripe piece of fruit","a great pen","a satisfying ‘done’ checklist moment"
      ],
      "wouldYouRather": [
        ["only reply in gifs for a day","only reply in voice notes for a day"],
        ["have a personal theme song that plays quietly","have a personal spotlight that follows you (politely)"],
        ["always know the perfect comeback 5 seconds later","always know the perfect answer 5 seconds earlier"],
        ["have unlimited free coffee/tea","have unlimited free snacks"],
        ["be able to fast-forward boring parts of life","be able to rewind awkward moments"]
      ],
      harmlessPersonal: [
        "What’s a food you didn’t like as a kid but like now?",
        "What’s a small thing that instantly puts you in a better mood?",
        "What’s a smell you associate with ‘comfort’?",
        "What’s something you’re looking forward to (big or small)?",
        "What’s your go-to way to recharge when your brain feels full?",
        "What’s a tiny luxury you love?",
        "What’s your current ‘comfort’ show/movie/song?",
        "What’s one hobby you’d try if you had a free afternoon and zero pressure?"
      ],
      lightWork: [
        "What’s a tiny change that would make meetings better?",
        "What’s a tool/template/shortcut you’d recommend to anyone?",
        "What’s one thing you’d love to automate (in a harmless way)?",
        "What’s a ‘good enough’ standard you’ve embraced that actually helps?",
        "What’s a productivity tip that sounds silly but works for you?"
      ]
    };

    function pick(arr, rnd) {
      return arr[Math.floor(rnd() * arr.length)];
    }
    function format(template, values) {
      return template.replace(/\{(\w+)\}/g, (_, k) => String(values[k] ?? `{${k}}`));
    }

    function mulberry32(seed) {
      return function() {
        let t = seed += 0x6D2B79F5;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }
    function hashStringToInt(str) {
      let h = 2166136261;
      for (let i = 0; i < str.length; i++) {
        h ^= str.charCodeAt(i);
        h = Math.imul(h, 16777619);
      }
      return h >>> 0;
    }
    function shuffleArray(arr) {
      const copy = [...arr];
      for (let i = copy.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [copy[i], copy[j]] = [copy[j], copy[i]];
      }
      return copy;
    }

    function generateQuestionBank(targetCount) {
      const seed = hashStringToInt(STORAGE_KEY);
      const rnd  = mulberry32(seed);

      const templates = [
        "What’s your {adj} favorite {topic} right now?",
        "What’s a {adj} {topic} you’d recommend to anyone?",
        "If you could only keep one {topic} forever, what would it be?",
        "What’s a {topic} you think is totally {adj}?",
        "What’s your go-to way to {activity}?",
        "What’s a {adj} thing that helps you {activity}?",
        "If you could have a ‘one-click’ fix for {workBit}, what would it do?",
        "What’s one {adj} habit that helps with {workBit}?",
        "What’s your most-used tip for {workBit}?",
        "If you could invite {personType} to lunch, who would you pick?",
        "What’s a question you wish people asked you more often (light answer ok)?",
        "If you got a free upgrade to {superpower}, how would you use it day-to-day?",
        "What’s a {adj} ‘small joy’ you appreciate lately (example: {smallJoy})?",
        "Would you rather {wyrA} or {wyrB}?",
        "What’s a harmless rule you’d add to make life 5% easier?",
        "What’s something you recently discovered that you’re slightly obsessed with?",
        "What’s a {topic} that feels like ‘you’ and why?",
        "What’s your favorite way to celebrate a tiny win?"
      ];

      const questions = new Set();
      for (const q of BANK.harmlessPersonal) questions.add(q);
      for (const q of BANK.lightWork) questions.add(q);

      let guard = 0;
      while (questions.size < targetCount && guard < targetCount * 50) {
        guard++;
        const wyrPair = pick(BANK["wouldYouRather"], rnd);
        const values = {
          adj: pick(BANK.adjectives, rnd),
          topic: pick(BANK.topics, rnd),
          activity: pick(BANK.activities, rnd),
          workBit: pick(BANK.workBits, rnd),
          personType: pick(BANK.questionsPeople, rnd),
          superpower: pick(BANK.superpowers, rnd),
          smallJoy: pick(BANK.smallJoys, rnd),
          wyrA: wyrPair[0],
          wyrB: wyrPair[1]
        };
        const t = pick(templates, rnd);
        const q = format(t, values).replace(/\s+/g, " ").trim().replace(/\?{2,}/g, "?");
        if (q.length >= 18 && q.length <= 140) questions.add(q);
      }
      return Array.from(questions);
    }

    function loadState() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY);
        return raw ? JSON.parse(raw) : null;
      } catch {
        return null;
      }
    }
    function saveState(state) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }
    function freshState(bank) {
      return { bank, order: shuffleArray(bank), index: 0, cycle: 1 };
    }
    function ensureValidState(state, bank) {
      if (!state || !Array.isArray(state.bank) || !Array.isArray(state.order) || typeof state.index !== "number") {
        return freshState(bank);
      }
      if (state.bank.length !== bank.length) return freshState(bank);
      const setA = new Set(state.bank);
      const setB = new Set(bank);
      if (setA.size !== setB.size) return freshState(bank);
      for (const q of setB) if (!setA.has(q)) return freshState(bank);
      state.index = Math.max(0, Math.min(state.index, state.order.length));
      state.cycle = state.cycle || 1;
      return state;
    }
    function getNextQuestion(state) {
      if (state.index >= state.order.length) {
        state.order = shuffleArray(state.bank);
        state.index = 0;
        state.cycle += 1;
      }
      const q = state.order[state.index];
      state.index += 1;
      return q;
    }

    function setParam(name, value) {
      const u = new URL(window.location.href);
      u.searchParams.set(name, value);
      window.history.replaceState({}, "", u.toString());
      return u.toString();
    }
    function getParam(name) {
      const u = new URL(window.location.href);
      return u.searchParams.get(name);
    }

    function setLever(on){
      const lever = document.getElementById("lever");
      if (!lever) return;
      lever.classList.toggle("pulled", on);
      if (on) setTimeout(() => lever.classList.remove("pulled"), 180);
    }

    function render(state, question, mode) {
      document.getElementById("question").textContent = question;

      const url = setParam("q", question);
      document.getElementById("linkBox").value = url;

      const remaining = state.order.length - state.index;
      const bankSize = state.bank.length;

      const meta = document.getElementById("meta");
      meta.innerHTML = "";
      const mk = (txt) => {
        const s = document.createElement("span");
        s.className = "chip";
        s.textContent = txt;
        return s;
      };

      if (mode === "link") {
        meta.appendChild(mk("Locked from link"));
        meta.appendChild(mk(`Bank: ${bankSize}`));
      } else {
        meta.appendChild(mk("No repeats"));
        meta.appendChild(mk(`Remaining: ${remaining}`));
        meta.appendChild(mk(`Cycle: ${state.cycle}`));
        meta.appendChild(mk(`Bank: ${bankSize}`));
      }

      document.getElementById("bankInfo").textContent =
        mode === "link" ? "Viewing a locked question" : "Pull lever for the next one →";
    }

    async function copyToClipboard(text) {
      try {
        await navigator.clipboard.writeText(text);
        return true;
      } catch {
        try {
          const box = document.getElementById("linkBox");
          box.focus();
          box.select();
          document.execCommand("copy");
          return true;
        } catch {
          return false;
        }
      }
    }

    const bank = generateQuestionBank(TARGET_COUNT);
    let state = ensureValidState(loadState(), bank);
    saveState(state);

    const linked = getParam("q");
    if (linked) {
      render(state, linked, "link");
    } else {
      const first = getNextQuestion(state);
      saveState(state);
      render(state, first, "shuffled");
    }

    document.getElementById("nextBtn").addEventListener("click", () => {
      setLever(true);
      const q = getNextQuestion(state);
      saveState(state);
      render(state, q, "shuffled");
    });

    document.getElementById("resetBtn").addEventListener("click", () => {
      state = freshState(bank);
      saveState(state);
      setLever(true);
      const q = getNextQuestion(state);
      saveState(state);
      render(state, q, "shuffled");
    });

    document.getElementById("copyBtn").addEventListener("click", async () => {
      const link = document.getElementById("linkBox").value;
      const ok = await copyToClipboard(link);
      const btn = document.getElementById("copyBtn");
      const old = btn.textContent;
      btn.textContent = ok ? "Copied!" : "Copy failed";
      setTimeout(() => (btn.textContent = old), 1200);
    });
  </script>
</body>
</html>
